-- QUERY TO GET USERS PRIV

--for oracle

SELECT 
A.SERVER_NAME AS SERVERNAME, 
A.DATABASE_NAME AS DATABASE, 
B.GRANTEE AS USERNAME, 
B.PRIVILEGE AS PRIVILEGS_AND_ROLES,
'NA' AS LOGIN_TYPE,
'ORACLE' AS DATABASE_TYPE
FROM (
    SELECT 
      GRANTEE,
      PRIVILEGE    
    FROM
      DBA_SYS_PRIVS   
    WHERE GRANTEE IN (SELECT USERNAME FROM DBA_USERS)     
    UNION      
    SELECT
      GRANTEE,
      PRIVILEGE
    FROM
      DBA_SYS_PRIVS
    WHERE GRANTEE IN (SELECT USERNAME FROM DBA_USERS)
) B,
(SELECT HOST_NAME AS SERVER_NAME, INSTANCE_NAME AS DATABASE_NAME FROM V$INSTANCE) A

ORDER BY 1,2,3,4;



--for vertica

SELECT 
B.NODE_ADDRESS AS HOSTNAME , 
A.DATABASE_NAME AS DATABASE, 
GRANTEE AS USERNAME, 
PRIVILEGES_DESCRIPTION AS PRIVILEGS_AND_ROLES,
'NA' AS LOGIN_TYPE,
'VERTICA' AS DATABASE_TYPE
FROM 
  GRANTS , 
  (SELECT DATABASE_NAME FROM DATABASES) A,
  (SELECT NODE_ADDRESS FROM NODES LIMIT 1 OFFSET 0) B
  WHERE GRANTEE NOT IN ('DBADMIN','PUBLIC');

  -- for mssql

SELECT servername as SERVERNAME, dbname as 'DATABASE',username as USERNAME,
Permissions_user as PRIVILEGS_AND_ROLES,logintype as LOGIN_TYPE,
'MSSQL' AS DATABASE_TYPE from master.dbo.dbuser;